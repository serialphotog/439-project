{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/calc.js","src/lib/engine.js","src/lib/history.js","src/lib/ui.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","_ui","window","addEventListener","init","event","removeEventListener","type","Interface","UI","initListeners","document","handleKeyPress","Calculator","factorialize","num","this","toPostfix","expression","out","stack","operators","^","precedence","associativity","!","/","*","+","-","replace","Math","PI","split","clean","token","push","isNumeric","indexOf","b","pop","calc","postfix","base","parseFloat","pow","sqrt","sin","cos","Infinity","tan","log","res","isNaN","toString","String","prototype","isFinite","Array","splice","History","maxItems","currentIdx","store","insert","current","max","tmp","getHistory","setMaxItems","expressionStr","history","_history","historyIndex","displayingResult","_this","btn_ac","querySelector","btn_del","btn_div","btn_one","btn_two","btn_three","btn_mul","btn_four","btn_five","btn_six","btn_plus","btn_seven","btn_eight","btn_nine","btn_min","btn_dec","btn_zero","btn_eq","btn_sin","btn_cos","btn_tan","btn_log","btn_pi","btn_sqrt","btn_factorial","btn_lparen","btn_rparen","btn_squared","btn_power","btn_cube","updateExpression","solve","_engine","expr","updateDisplay","op","substring","innerHTML","shiftKey","hist","item"],"mappings":"CAAA,SAAAA,EAAAC,EAAAC,EAAAC,GAAA,SAAAC,EAAAC,EAAAC,GAAA,IAAAJ,EAAAG,GAAA,CAAA,IAAAJ,EAAAI,GAAA,CAAA,IAAAE,EAAA,mBAAAC,SAAAA,QAAA,IAAAF,GAAAC,EAAA,OAAAA,EAAAF,GAAA,GAAA,GAAAI,EAAA,OAAAA,EAAAJ,GAAA,GAAA,IAAAK,EAAA,IAAAC,MAAA,uBAAAN,EAAA,KAAA,MAAAK,EAAAE,KAAA,mBAAAF,EAAA,IAAAG,EAAAX,EAAAG,GAAA,CAAAS,QAAA,IAAAb,EAAAI,GAAA,GAAAU,KAAAF,EAAAC,QAAA,SAAAd,GAAA,OAAAI,EAAAH,EAAAI,GAAA,GAAAL,IAAAA,IAAAa,EAAAA,EAAAC,QAAAd,EAAAC,EAAAC,EAAAC,GAAA,OAAAD,EAAAG,GAAAS,QAAA,IAAA,IAAAL,EAAA,mBAAAD,SAAAA,QAAAH,EAAA,EAAAA,EAAAF,EAAAa,OAAAX,IAAAD,EAAAD,EAAAE,IAAA,OAAAD,EAAA,CAAA,CAAAa,EAAA,CAAA,SAAAT,EAAAU,EAAAJ,gBCAA,IAAAK,EAAAX,EAAA,eAEAY,OAAOC,iBAAiB,OAAQ,SAASC,EAAKC,GAE7CH,OAAOI,oBAAoBD,EAAME,KAAMH,GAAM,GAG7C,IAAII,EAAY,IAAIP,EAAAQ,GACpBD,EAAUE,gBAEVC,SAASR,iBAAiB,QAAS,SAACpB,GACnCyB,EAAUI,eAAe7B,OAExB,0GCOa8B,WAAT,WAiGN,SAASC,EAAaC,GACrB,OAAIA,EAAM,GACD,EACO,GAAPA,EACD,EAECA,EAAMD,EAAaC,EAAM,GAnGnCC,KAAKC,UAAY,SAASC,GACzB,IAAIC,EAAM,GACNC,EAAQ,GAGRC,EAAY,CACfC,IAAK,CACJC,WAAY,EACZC,cAAe,SAGhBC,IAAK,CACJF,WAAY,EACZC,cAAe,SAGhBE,IAAK,CACJH,WAAY,EACZC,cAAe,QAGhBG,IAAK,CACJJ,WAAY,EACZC,cAAe,QAGhBI,IAAK,CACJL,WAAY,EACZC,cAAe,QAGhBK,IAAK,CACJN,WAAY,EACZC,cAAe,SAUjBN,GAFAA,GAHAA,EAAaA,EAAWY,QAAQ,OAAQC,KAAKC,KAGrBF,QAAQ,OAAQ,KAEhBG,MAAM,wBAAwBC,QAGtD,IAAK,IAAI/C,EAAE,EAAGA,EAAI+B,EAAWpB,OAAQX,IAAK,CACzC,IAAIgD,EAAQjB,EAAW/B,GAcvB,GAZa,QAATgD,EACHf,EAAMgB,KAAK,SACQ,OAATD,EACVf,EAAMgB,KAAK,QACQ,OAATD,EACVf,EAAMgB,KAAK,QACQ,OAATD,EACVf,EAAMgB,KAAK,QACQ,OAATD,GACVf,EAAMgB,KAAK,QAGRD,EAAME,YACTlB,GAAOgB,EAAQ,SACT,IAAiC,IAA7B,SAASG,QAAQH,GAAe,CAK1C,IAHA,IAAI3C,EAAI2C,EACJI,EAAInB,EAAMA,EAAMtB,OAAS,IAEG,IAAzB,SAASwC,QAAQC,KAA6C,QAA9BlB,EAAU7B,GAAGgC,eAA2BH,EAAU7B,GAAG+B,YAAcF,EAAUkB,GAAGhB,YACxF,SAA9BF,EAAU7B,GAAGgC,eAA4BH,EAAUkB,GAAGhB,WAAaF,EAAUkB,GAAGhB,aAChFJ,GAAOC,EAAMoB,MAAQ,IACrBD,EAAInB,EAAMA,EAAMtB,OAAS,GAG1BsB,EAAMgB,KAAK5C,QACL,GAAa,KAAT2C,EACVf,EAAMgB,KAAKD,QACL,GAAa,KAATA,EAAc,CACxB,KAAmC,MAA5Bf,EAAMA,EAAMtB,OAAS,IAC3BqB,GAAOC,EAAMoB,MAAQ,IAGtBpB,EAAMoB,OAIR,KAAsB,EAAfpB,EAAMtB,QACZqB,GAAOC,EAAMoB,MAAQ,IAGtB,OAAOrB,GAiBRH,KAAKyB,KAAO,SAASC,GACpB,IANiB3B,EAAK4B,EAMlBvB,EAAQ,GAGZsB,EAAUA,EAAQT,MAAM,KAAKC,QAG7B,IAAK,IAAI/C,EAAE,EAAGA,EAAIuD,EAAQ5C,OAAQX,IACjC,GAAIuD,EAAQvD,GAAGkD,YACdjB,EAAMgB,KAAKM,EAAQvD,QACb,CACN,IAAIK,EAAI4B,EAAMoB,MACVD,EAAInB,EAAMoB,MAEK,MAAfE,EAAQvD,GACXiC,EAAMgB,KAAKQ,WAAWpD,GAAKoD,WAAWL,IACb,MAAfG,EAAQvD,GAClBiC,EAAMgB,KAAKQ,WAAWL,GAAKK,WAAWpD,IACb,MAAfkD,EAAQvD,GAClBiC,EAAMgB,KAAKQ,WAAWpD,GAAKoD,WAAWL,IACb,MAAfG,EAAQvD,GAClBiC,EAAMgB,KAAKQ,WAAWL,GAAKK,WAAWpD,IACb,MAAfkD,EAAQvD,GAClBiC,EAAMgB,KAAKL,KAAKc,IAAID,WAAWL,GAAIK,WAAWpD,KACtB,KAAdkD,EAAQvD,GAClBiC,EAAMgB,KAAKtB,EAAatB,IACA,SAAdkD,EAAQvD,GAClBiC,EAAMgB,KAAKL,KAAKe,KAAKtD,IACG,QAAdkD,EAAQvD,GAClBiC,EAAMgB,KAAKL,KAAKgB,IAAIvD,EAAIuC,KAAKC,GAAK,MACV,QAAdU,EAAQvD,GAET,IAALK,EACH4B,EAAMgB,KAAK,GAEXhB,EAAMgB,KAAKL,KAAKiB,IAAIxD,EAAIuC,KAAKC,GAAK,MACX,QAAdU,EAAQvD,GAET,IAALK,EACH4B,EAAMgB,KAAKa,EAAAA,GAEX7B,EAAMgB,KAAKL,KAAKmB,IAAI1D,EAAIuC,KAAKC,GAAK,MACX,QAAdU,EAAQvD,IAClBiC,EAAMgB,MAhDQrB,EAgDMvB,EAhDDmD,EAgDI,GA/CnBZ,KAAKoB,IAAIpC,GAAOgB,KAAKoB,IAAIR,KAoDhC,GAAmB,EAAfvB,EAAMtB,OACT,MAAO,eAEP,IAAIsD,EAAMhC,EAAMoB,MAKhB,MAJW,OAAPY,GAAgBC,MAAMD,GACzBA,EAAM,gBACS,YAAPA,IACRA,EAAM,WACAA,EAAIE,aAxLdC,OAAOC,UAAUnB,UAAY,WAC5B,OAAQgB,MAAMT,WAAW5B,QAAUyC,SAASzC,OAM7C0C,MAAMF,UAAUtB,MAAQ,WACvB,IAAK,IAAI/C,EAAE,EAAGA,EAAI6B,KAAKlB,OAAQX,IACd,KAAZ6B,KAAK7B,IACR6B,KAAK2C,OAAOxE,EAAG,GAIjB,OAAO6B,8FCjBQ4C,QAAT,WACH5C,KAAK6C,SAAW,GAChB7C,KAAK8C,YAAc,EACnB9C,KAAK+C,MAAQ,GAGb/C,KAAKgD,OAAS,SAAS9C,GACnB,IAAI+C,EAAU/C,EACVgD,EAAMlD,KAAK8C,WAAW,EAS1B,GAPII,EAAMlD,KAAK6C,SAAS,GACpBK,EAAMlD,KAAK6C,SACX7C,KAAK8C,WAAa9C,KAAK6C,UAEvB7C,KAAK8C,aAGE,GAAPI,EAEAlD,KAAK+C,MAAM,GAAK7C,MACb,CACCgD,EAAI,EAAIlD,KAAK6C,SAAW,IACxBK,GAAK,GACT,IAAK,IAAI/E,EAAE,EAAGA,EAAI+E,EAAK/E,IAAK,CACxB,IAAIgF,EAAMnD,KAAK+C,MAAM5E,GACrB6B,KAAK+C,MAAM5E,GAAK8E,EAChBA,EAAUE,KAMtBnD,KAAKoD,WAAa,WACd,OAAOpD,KAAK+C,OAIhB/C,KAAKqD,YAAc,SAASH,GACxBlD,KAAK6C,SAAWK,4FCnCRzD,GAAT,WAENO,KAAKsD,cAAgB,GAGrBtD,KAAKuD,QAAU,IAAIC,EAAAZ,QAGnB5C,KAAKyD,cAAgB,EAGrBzD,KAAK0D,kBAAmB,EAGxB1D,KAAKN,cAAgB,WAAW,IAAAiE,EAAA3D,KAE3B4D,EAASjE,SAASkE,cAAc,WAChCC,EAAUnE,SAASkE,cAAc,YACjCE,EAAUpE,SAASkE,cAAc,YACjCG,EAAUrE,SAASkE,cAAc,YACjCI,EAAUtE,SAASkE,cAAc,YACjCK,EAAYvE,SAASkE,cAAc,cACnCM,EAAUxE,SAASkE,cAAc,YACjCO,EAAWzE,SAASkE,cAAc,aAClCQ,EAAW1E,SAASkE,cAAc,aAClCS,EAAU3E,SAASkE,cAAc,YACjCU,EAAW5E,SAASkE,cAAc,aAClCW,EAAY7E,SAASkE,cAAc,cACnCY,EAAY9E,SAASkE,cAAc,cACnCa,EAAW/E,SAASkE,cAAc,aAClCc,EAAUhF,SAASkE,cAAc,YACjCe,EAAUjF,SAASkE,cAAc,YACjCgB,EAAWlF,SAASkE,cAAc,aAClCiB,EAASnF,SAASkE,cAAc,YAChCkB,EAAUpF,SAASkE,cAAc,YAC3BmB,EAAUrF,SAASkE,cAAc,YACjCoB,EAAUtF,SAASkE,cAAc,YACjCqB,EAAUvF,SAASkE,cAAc,YACjCsB,EAASxF,SAASkE,cAAc,WAChCuB,EAAWzF,SAASkE,cAAc,aAClCwB,EAAgB1F,SAASkE,cAAc,kBACvCyB,EAAa3F,SAASkE,cAAc,eACpC0B,EAAa5F,SAASkE,cAAc,eACpC2B,EAAc7F,SAASkE,cAAc,gBACrC4B,EAAY9F,SAASkE,cAAc,cACnC6B,EAAW/F,SAASkE,cAAc,aAG5CD,EAAOzE,iBAAiB,QAAS,WAChCwE,EAAKgC,iBAAiB,QAEvB7B,EAAQ3E,iBAAiB,QAAS,WACjCwE,EAAKgC,iBAAiB,SAEvB5B,EAAQ5E,iBAAiB,QAAS,WACjCwE,EAAKgC,iBAAiB,OAEvB3B,EAAQ7E,iBAAiB,QAAS,WACjCwE,EAAKgC,iBAAiB,OAEvB1B,EAAQ9E,iBAAiB,QAAS,WACjCwE,EAAKgC,iBAAiB,OAEvBzB,EAAU/E,iBAAiB,QAAS,WACnCwE,EAAKgC,iBAAiB,OAEvBxB,EAAQhF,iBAAiB,QAAS,WACjCwE,EAAKgC,iBAAiB,OAEvBvB,EAASjF,iBAAiB,QAAS,WAClCwE,EAAKgC,iBAAiB,OAEvBtB,EAASlF,iBAAiB,QAAS,WAClCwE,EAAKgC,iBAAiB,OAEvBrB,EAAQnF,iBAAiB,QAAS,WACjCwE,EAAKgC,iBAAiB,OAEvBpB,EAASpF,iBAAiB,QAAS,WAClCwE,EAAKgC,iBAAiB,OAEvBnB,EAAUrF,iBAAiB,QAAS,WACnCwE,EAAKgC,iBAAiB,OAEvBlB,EAAUtF,iBAAiB,QAAS,WACnCwE,EAAKgC,iBAAiB,OAEvBjB,EAASvF,iBAAiB,QAAS,WAClCwE,EAAKgC,iBAAiB,OAEvBf,EAAQzF,iBAAiB,QAAS,WACjCwE,EAAKgC,iBAAiB,OAEvBhB,EAAQxF,iBAAiB,QAAS,WACjCwE,EAAKgC,iBAAiB,OAEvBd,EAAS1F,iBAAiB,QAAS,WAClCwE,EAAKgC,iBAAiB,OAIvBb,EAAO3F,iBAAiB,QAAS,WAChCwE,EAAKiC,UAENb,EAAQ5F,iBAAiB,QAAS,WACxBwE,EAAKgC,iBAAiB,UAE1BX,EAAQ7F,iBAAiB,QAAS,WAC9BwE,EAAKgC,iBAAiB,UAE1BV,EAAQ9F,iBAAiB,QAAS,WAC9BwE,EAAKgC,iBAAiB,UAE1BR,EAAOhG,iBAAiB,QAAS,WAC7BwE,EAAKgC,iBAAiB,UAE1BP,EAASjG,iBAAiB,QAAS,WAC/BwE,EAAKgC,iBAAiB,WAE1BT,EAAQ/F,iBAAiB,QAAS,WAC9BwE,EAAKgC,iBAAiB,UAE1BN,EAAclG,iBAAiB,QAAS,WACvCwE,EAAKgC,iBAAiB,OAEvBL,EAAWnG,iBAAiB,QAAS,WACpCwE,EAAKgC,iBAAiB,OAEvBJ,EAAWpG,iBAAiB,QAAS,WACpCwE,EAAKgC,iBAAiB,OAEvBH,EAAYrG,iBAAiB,QAAS,WACrCwE,EAAKgC,iBAAiB,QAEvBD,EAASvG,iBAAiB,QAAS,WAClCwE,EAAKgC,iBAAiB,QAEvBF,EAAUtG,iBAAiB,QAAS,WACnCwE,EAAKgC,iBAAiB,QAK9B3F,KAAK4F,MAAQ,WACZ,IAAInE,EAAO,IAAIoE,EAAAhG,WACXiG,EAAOrE,EAAKxB,UAAUD,KAAKsD,eAC3BlB,EAAMX,EAAKA,KAAKqE,GACpB9F,KAAKuD,QAAQP,OAAOZ,GACpBpC,KAAKsD,cAAgBlB,EACrBpC,KAAK0D,kBAAmB,EACxB1D,KAAK+F,iBAIN/F,KAAK2F,iBAAmB,SAASK,GAChC,OAAQA,GACP,IAAK,KACJhG,KAAKsD,cAAgB,GACrB,MACD,IAAK,MACsB,MAAtBtD,KAAKsD,gBACRtD,KAAKsD,cAAgBtD,KAAKsD,cAAc2C,UAAU,EAAGjG,KAAKsD,cAAcxE,OAAS,IAClF,MACD,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,KACL,IAAK,KACL,IAAK,IACL,IAAK,IACJkB,KAAKsD,eAAiB0C,EACtB,MACD,IAAK,QACJhG,KAAKsD,cAAgB0C,EAAKhG,KAAKsD,cAC/B,MACD,QACKtD,KAAK0D,mBACR1D,KAAKsD,cAAgB,IACtBtD,KAAKsD,eAAiB0C,EAIxBhG,KAAK0D,kBAAmB,EACxB1D,KAAK+F,iBAIN/F,KAAK+F,cAAgB,WACNpG,SAASkE,cAAc,WAC7BqC,UAAYlG,KAAKsD,eAG1BtD,KAAKJ,eAAiB,SAAS7B,GAC9B,OAAQA,EAAEW,MACT,IAAK,UACL,IAAK,SACAX,EAAEoI,SACLnG,KAAK2F,iBAAiB,KAEtB3F,KAAK2F,iBAAiB,GACvB,MACD,IAAK,UACL,IAAK,SACJ3F,KAAK2F,iBAAiB,GACtB,MACD,IAAK,UACL,IAAK,SACJ3F,KAAK2F,iBAAiB,GACtB,MACD,IAAK,UACL,IAAK,SACJ3F,KAAK2F,iBAAiB,GACtB,MACD,IAAK,UACL,IAAK,SACJ3F,KAAK2F,iBAAiB,GACtB,MACD,IAAK,UACL,IAAK,SACJ3F,KAAK2F,iBAAiB,GACtB,MACD,IAAK,UACL,IAAK,SACJ3F,KAAK2F,iBAAiB,GACtB,MACD,IAAK,UACL,IAAK,SACJ3F,KAAK2F,iBAAiB,GACtB,MACD,IAAK,UACL,IAAK,SACJ3F,KAAK2F,iBAAiB,GACtB,MACD,IAAK,UACL,IAAK,SACA5H,EAAEoI,SACLnG,KAAK2F,iBAAiB,KAEtB3F,KAAK2F,iBAAiB,GACvB,MACD,IAAK,SACJ3F,KAAK2F,iBAAiB,MACtB,MACD,IAAK,YACJ3F,KAAK2F,iBAAiB,OACtB,MACD,IAAK,QACL,IAAK,eACJ3F,KAAK2F,iBAAiB,KACtB,MACD,IAAK,QACL,IAAK,iBACJ3F,KAAK2F,iBAAiB,KACtB,MACD,IAAK,YACJ3F,KAAK2F,iBAAiB,KACtB,MACD,IAAK,iBACJ3F,KAAK2F,iBAAiB,KACtB,MACD,IAAK,cACJ3F,KAAK4F,QACL,MACD,IAAK,QACA7H,EAAEoI,SACLnG,KAAK2F,iBAAiB,KAEtB3F,KAAK4F,QACN,MACD,IAAK,UACL,IAAK,YACJ,IAAIQ,EAAOpG,KAAKuD,QAAQH,aAEpBiD,EAAO,YACG,WAAVtI,EAAEW,KAEO,OADZ2H,EAAOD,GAAMpG,KAAKyD,aAAe,GAAK2C,EAAKtH,UACf,aAARuH,GAEnBrG,KAAKyD,cAAgBzD,KAAKyD,aAAe,GAAK2C,EAAKtH,OACnDkB,KAAKsD,cAAgB+C,GAGrBrG,KAAKyD,aAAe,EAIT,OADZ4C,EAAOD,GAAMpG,KAAKyD,aAAe,GAAK2C,EAAKtH,UACf,aAARuH,GAEnBrG,KAAKyD,cAAgBzD,KAAKyD,aAAe,GAAK2C,EAAKtH,OACnDkB,KAAKsD,cAAgB+C,GAGrBrG,KAAKyD,aAAe2C,EAAKtH,OAI3BkB,KAAK+F,mBA5ST,IAAAF,EAAAvH,EAAA,eACAkF,EAAAlF,EAAA","file":"calc.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import {UI} from './lib/ui.js';\r\n\r\nwindow.addEventListener(\"load\", function init(event) {\r\n\t// Only run the initialization once\r\n\twindow.removeEventListener(event.type, init, false);\r\n\r\n\t// Initialize the UI\r\n\tvar Interface = new UI();\r\n\tInterface.initListeners();\r\n\r\n\tdocument.addEventListener(\"keyup\", (e) => {\r\n\t\tInterface.handleKeyPress(e);\r\n\t});\r\n}, false);","/**\r\n * Checks is a string represents a numeric value.\r\n */\r\nString.prototype.isNumeric = function() {\r\n\treturn !isNaN(parseFloat(this)) && isFinite(this);\r\n}\r\n\r\n/**\r\n * Cleans empty items from an array.\r\n */\r\nArray.prototype.clean = function() {\r\n\tfor (var i=0; i < this.length; i++) {\r\n\t\tif (this[i] === \"\") {\r\n\t\t\tthis.splice(i, 1);\r\n\t\t}\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n\r\nexport function Calculator() {\r\n\r\n\t// Converts an infix expression to postfix\r\n\t// This is using the Shunting Yard Algorithm\r\n\tthis.toPostfix = function(expression) {\r\n\t\tvar out = \"\"; // The output queue\r\n\t\tvar stack = []; // The operators stack\r\n\r\n\t\t// Opeartor definitions\r\n\t\tvar operators = {\r\n\t\t\t\"^\": {\r\n\t\t\t\tprecedence: 4,\r\n\t\t\t\tassociativity: \"right\"\r\n\t\t\t},\r\n\r\n\t\t\t\"!\": {\r\n\t\t\t\tprecedence: 4,\r\n\t\t\t\tassociativity: \"right\"\r\n\t\t\t},\r\n\r\n\t\t\t\"/\": {\r\n\t\t\t\tprecedence: 3,\r\n\t\t\t\tassociativity: \"left\"\r\n\t\t\t}, \r\n\r\n\t\t\t\"*\": {\r\n\t\t\t\tprecedence: 3,\r\n\t\t\t\tassociativity: \"left\"\r\n\t\t\t},\r\n\r\n\t\t\t\"+\": {\r\n\t\t\t\tprecedence: 2,\r\n\t\t\t\tassociativity: \"left\"\r\n\t\t\t},\r\n\r\n\t\t\t\"-\": {\r\n\t\t\t\tprecedence: 2,\r\n\t\t\t\tassociativity: \"left\"\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Find and replace constants\r\n\t\texpression = expression.replace(/&pi;/, Math.PI);\r\n\r\n\t\t// Removes one or more occurences of whitespace globally\r\n\t\texpression = expression.replace(/\\s+/g, \"\");\r\n\t\t// Searches for operators and splits the expression on them\r\n\t\texpression = expression.split(/([\\+\\-\\*\\/\\^\\(\\)\\!])/).clean();\r\n\r\n\t\t// Parse the expression\r\n\t\tfor (var i=0; i < expression.length; i++) {\r\n\t\t\tvar token = expression[i];\r\n\r\n\t\t\tif (token == \"sqrt\") {\r\n\t\t\t\tstack.push(\"sqrt(\");\r\n\t\t\t} else if (token == \"sin\") {\r\n\t\t\t\tstack.push(\"sin(\");\r\n\t\t\t} else if (token == \"cos\") {\r\n\t\t\t\tstack.push(\"cos(\");\r\n\t\t\t} else if (token == \"tan\") {\r\n\t\t\t\tstack.push(\"tan(\");\r\n\t\t\t} else if (token == \"log\") {\r\n\t\t\t\tstack.push(\"log(\");\r\n\t\t\t}\r\n\r\n\t\t\tif (token.isNumeric()) {\r\n\t\t\t\tout += token + \" \";\r\n\t\t\t} else if (\"^*/+-!\".indexOf(token) !== -1) {\r\n\t\t\t\t// This is an operator token\r\n\t\t\t\tvar a = token;\r\n\t\t\t\tvar b = stack[stack.length - 1];\r\n\r\n\t\t\t\twhile (\"^*/+-!\".indexOf(b) !== -1 && ((operators[a].associativity == \"left\" && operators[a].precedence <= operators[b].precedence) || \r\n\t\t\t\t\toperators[a].associativity == \"right\" && operators[b].precedence < operators[b].precedence)) {\r\n\t\t\t\t\tout += stack.pop() + \" \";\r\n\t\t\t\t\tb = stack[stack.length - 1];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstack.push(a);\r\n\t\t\t} else if (token == \"(\") {\r\n\t\t\t\tstack.push(token);\r\n\t\t\t} else if (token == \")\") {\r\n\t\t\t\twhile (stack[stack.length - 1] !== \"(\") {\r\n\t\t\t\t\tout += stack.pop() + \" \";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstack.pop();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\twhile (stack.length > 0) {\r\n\t\t\tout += stack.pop() + \" \";\r\n\t\t}\r\n\r\n\t\treturn out;\r\n\t}\r\n\r\n\tfunction factorialize(num) {\r\n\t\tif (num < 0)\r\n\t\t\treturn -1;\r\n\t\telse if (num == 0)\r\n\t\t\treturn 1;\r\n\t\telse \r\n\t\t\treturn (num * factorialize(num - 1));\r\n\t}\r\n\r\n\tfunction logBaseN(num, base) {\r\n\t\treturn Math.log(num) / Math.log(base);\r\n\t}\r\n\r\n\t// Given an expression in postifx, solve it\r\n\tthis.calc = function(postfix) {\r\n\t\tvar stack = []; // The result stack\r\n\r\n\t\t// Split the postfix on spaces\r\n\t\tpostfix = postfix.split(\" \").clean();\r\n\r\n\t\t// Solve it!\r\n\t\tfor (var i=0; i < postfix.length; i++) {\r\n\t\t\tif (postfix[i].isNumeric()) {\r\n\t\t\t\tstack.push(postfix[i]);\r\n\t\t\t} else { // Operator\r\n\t\t\t\tvar a = stack.pop();\r\n\t\t\t\tvar b = stack.pop();\r\n\r\n\t\t\t\tif (postfix[i] === \"+\") {\r\n\t\t\t\t\tstack.push(parseFloat(a) + parseFloat(b));\r\n\t\t\t\t} else if (postfix[i] === \"-\") {\r\n\t\t\t\t\tstack.push(parseFloat(b) - parseFloat(a));\r\n\t\t\t\t} else if (postfix[i] === \"*\") {\r\n\t\t\t\t\tstack.push(parseFloat(a) * parseFloat(b));\r\n\t\t\t\t} else if (postfix[i] === \"/\") {\r\n\t\t\t\t\tstack.push(parseFloat(b) / parseFloat(a));\r\n\t\t\t\t} else if (postfix[i] === \"^\") {\r\n\t\t\t\t\tstack.push(Math.pow(parseFloat(b), parseFloat(a)));\r\n\t\t\t\t} else if (postfix[i] == \"!\") {\r\n\t\t\t\t\tstack.push(factorialize(a));\r\n\t\t\t\t} else if (postfix[i] == \"sqrt(\") {\r\n\t\t\t\t\tstack.push(Math.sqrt(a));\r\n\t\t\t\t} else if (postfix[i] == \"sin(\") {\r\n\t\t\t\t\tstack.push(Math.sin(a * Math.PI / 180.0));\r\n\t\t\t\t} else if (postfix[i] == \"cos(\") {\r\n\t\t\t\t\t// Fix for a bug in the way JS calculates the cosine of 90\r\n\t\t\t\t\tif (a == 90)\r\n\t\t\t\t\t\tstack.push(1);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tstack.push(Math.cos(a * Math.PI / 180.0));\r\n\t\t\t\t} else if (postfix[i] == \"tan(\") {\r\n\t\t\t\t\t// Deal with the edge case of tangent of 90\r\n\t\t\t\t\tif (a == 90)\r\n\t\t\t\t\t\tstack.push(Infinity);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tstack.push(Math.tan(a * Math.PI / 180.0));\r\n\t\t\t\t} else if (postfix[i] == \"log(\") {\r\n\t\t\t\t\tstack.push(logBaseN(a, 10));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (stack.length > 1) {\r\n\t\t\treturn \"Syntax Error\";\r\n\t\t} else {\r\n\t\t\tvar res = stack.pop();\r\n\t\t\tif (res == \"NaN\" || isNaN(res))\r\n\t\t\t\tres = \"Syntax Error!\";\r\n\t\t\telse if (res == \"Infinity\")\r\n\t\t\t\tres = \"&#8734;\";\r\n\t\t\treturn res.toString();\r\n\t\t}\r\n\t}\r\n\r\n}","export function History() {\r\n    this.maxItems = 10; // The max items to store in history\r\n    this.currentIdx = -1;\r\n    this.store = []; // Storage for the history\r\n\r\n    // Adds an expression to the history list\r\n    this.insert = function(expression) {\r\n        var current = expression;\r\n        var max = this.currentIdx+1;\r\n    \r\n        if (max > this.maxItems-1) {\r\n            max = this.maxItems;\r\n            this.currentIdx = this.maxItems;\r\n        } else {\r\n            this.currentIdx++;\r\n        }\r\n\r\n        if (max == 0)\r\n        {\r\n            this.store[0] = expression;\r\n        } else {\r\n            if (max+1 < this.maxItems - 1)\r\n                max+=1;\r\n            for (var i=0; i < max; i++) {\r\n                var tmp = this.store[i];\r\n                this.store[i] = current;\r\n                current = tmp;\r\n            }\r\n        }\r\n    }\r\n\r\n    // Returns the history store\r\n    this.getHistory = function() {\r\n        return this.store;\r\n    }\r\n\r\n    // Sets the max number of items to be stored in history\r\n    this.setMaxItems = function(max) {\r\n        this.maxItems = max;\r\n    }\r\n}","import {Calculator} from './engine.js';\r\nimport {History} from './history.js';\r\n\r\nexport function UI() {\r\n\t// The current expression string\r\n\tthis.expressionStr = \"\";\r\n\r\n\t// The history storage object\r\n\tthis.history = new History();\r\n\r\n\t// The current index into the history array\r\n\tthis.historyIndex = -1;\r\n\r\n\t// Tracks if the display is set to a result\r\n\tthis.displayingResult = false;\r\n\r\n\t// Initializes the UI event listeners\r\n\tthis.initListeners = function() {\r\n\t\t// Load the buttons\r\n\t\tvar btn_ac = document.querySelector(\"#btn_ac\");\r\n\t\tvar btn_del = document.querySelector(\"#btn_del\");\r\n\t\tvar btn_div = document.querySelector(\"#btn_div\");\r\n\t\tvar btn_one = document.querySelector(\"#btn_one\");\r\n\t\tvar btn_two = document.querySelector(\"#btn_two\");\r\n\t\tvar btn_three = document.querySelector(\"#btn_three\");\r\n\t\tvar btn_mul = document.querySelector(\"#btn_mul\");\r\n\t\tvar btn_four = document.querySelector(\"#btn_four\");\r\n\t\tvar btn_five = document.querySelector(\"#btn_five\");\r\n\t\tvar btn_six = document.querySelector(\"#btn_six\");\r\n\t\tvar btn_plus = document.querySelector(\"#btn_plus\");\r\n\t\tvar btn_seven = document.querySelector(\"#btn_seven\");\r\n\t\tvar btn_eight = document.querySelector(\"#btn_eight\");\r\n\t\tvar btn_nine = document.querySelector(\"#btn_nine\");\r\n\t\tvar btn_min = document.querySelector(\"#btn_min\");\r\n\t\tvar btn_dec = document.querySelector(\"#btn_dec\");\r\n\t\tvar btn_zero = document.querySelector(\"#btn_zero\");\r\n\t\tvar btn_eq = document.querySelector(\"#btn_equ\");\r\n\t\tvar btn_sin = document.querySelector(\"#btn_sin\");\r\n        var btn_cos = document.querySelector(\"#btn_cos\");\r\n        var btn_tan = document.querySelector(\"#btn_tan\");\r\n        var btn_log = document.querySelector(\"#btn_log\");\r\n        var btn_pi = document.querySelector(\"#btn_pi\");\r\n        var btn_sqrt = document.querySelector(\"#btn_sqrt\");\r\n        var btn_factorial = document.querySelector(\"#btn_factorial\");\r\n        var btn_lparen = document.querySelector(\"#btn_lparen\");\r\n        var btn_rparen = document.querySelector(\"#btn_rparen\");\r\n        var btn_squared = document.querySelector(\"#btn_squared\");\r\n        var btn_power = document.querySelector(\"#btn_power\");\r\n        var btn_cube = document.querySelector(\"#btn_cube\");\r\n\r\n\t\t// Add the listeners\r\n\t\tbtn_ac.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"AC\");\r\n\t\t});\r\n\t\tbtn_del.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"DEL\");\r\n\t\t});\r\n\t\tbtn_div.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"/\");\r\n\t\t});\r\n\t\tbtn_one.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"1\");\r\n\t\t});\r\n\t\tbtn_two.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"2\");\r\n\t\t});\r\n\t\tbtn_three.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"3\");\r\n\t\t});\r\n\t\tbtn_mul.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"*\");\r\n\t\t});\r\n\t\tbtn_four.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"4\");\r\n\t\t});\r\n\t\tbtn_five.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"5\");\r\n\t\t});\r\n\t\tbtn_six.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"6\");\r\n\t\t});\r\n\t\tbtn_plus.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"+\");\r\n\t\t});\r\n\t\tbtn_seven.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"7\");\r\n\t\t});\r\n\t\tbtn_eight.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"8\");\r\n\t\t});\r\n\t\tbtn_nine.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"9\");\r\n\t\t});\r\n\t\tbtn_dec.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\".\");\r\n\t\t});\r\n\t\tbtn_min.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"-\");\r\n\t\t});\r\n\t\tbtn_zero.addEventListener(\"click\", () => {\r\n\t\t\tthis.updateExpression(\"0\");\r\n\t\t});\r\n\r\n\t\t// Click handlers for mathematical functions\r\n\t\tbtn_eq.addEventListener(\"click\", () => {\r\n\t\t\tthis.solve();\r\n\t\t});\r\n\t\tbtn_sin.addEventListener(\"click\", () => {\r\n            this.updateExpression(\"sin(\");\r\n        });\r\n        btn_cos.addEventListener(\"click\", () => {\r\n            this.updateExpression(\"cos(\");\r\n        });\r\n        btn_tan.addEventListener(\"click\", () => {\r\n            this.updateExpression(\"tan(\");\r\n        });\r\n        btn_pi.addEventListener(\"click\", () => {\r\n            this.updateExpression(\"&pi;\");\r\n        });\r\n        btn_sqrt.addEventListener(\"click\", () => {\r\n            this.updateExpression(\"sqrt(\");\r\n        });\r\n        btn_log.addEventListener(\"click\", () => {\r\n            this.updateExpression(\"log(\");\r\n        });\r\n        btn_factorial.addEventListener(\"click\", () => {\r\n        \tthis.updateExpression(\"!\");\r\n        });\r\n        btn_lparen.addEventListener(\"click\", () => {\r\n        \tthis.updateExpression(\"(\");\r\n        });\r\n        btn_rparen.addEventListener(\"click\", () => {\r\n        \tthis.updateExpression(\")\");\r\n        });\r\n        btn_squared.addEventListener(\"click\", () => {\r\n        \tthis.updateExpression(\"^2\");\r\n        });\r\n        btn_cube.addEventListener(\"click\", () => {\r\n        \tthis.updateExpression(\"^3\");\r\n        })\r\n        btn_power.addEventListener(\"click\", () => {\r\n        \tthis.updateExpression(\"^\");\r\n        });\r\n\t}\r\n\r\n\t// Uses the calculator engine to solve an expression\r\n\tthis.solve = function() {\r\n\t\tvar calc = new Calculator();\r\n\t\tvar expr = calc.toPostfix(this.expressionStr);\r\n\t\tvar res = calc.calc(expr);\r\n\t\tthis.history.insert(res);\r\n\t\tthis.expressionStr = res;\r\n\t\tthis.displayingResult = true;\r\n\t\tthis.updateDisplay();\r\n\t}\r\n\r\n\t// Updates the expression\r\n\tthis.updateExpression = function(op) {\r\n\t\tswitch (op) {\r\n\t\t\tcase \"AC\":\r\n\t\t\t\tthis.expressionStr = \"\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"DEL\": \r\n\t\t\t\tif (this.expressionStr != null)\r\n\t\t\t\t\tthis.expressionStr = this.expressionStr.substring(0, this.expressionStr.length - 1);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"+\":\r\n\t\t\tcase \"*\":\r\n\t\t\tcase \"/\":\r\n\t\t\tcase \"-\":\r\n\t\t\tcase \"^2\":\r\n\t\t\tcase \"^3\":\r\n\t\t\tcase \"^\":\r\n\t\t\tcase \"!\":\r\n\t\t\t\tthis.expressionStr += op;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"sqrt(\":\r\n\t\t\t\tthis.expressionStr = op + this.expressionStr;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tif (this.displayingResult)\r\n\t\t\t\t\tthis.expressionStr = \"\";\r\n\t\t\t\tthis.expressionStr += op;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tthis.displayingResult = false;\r\n\t\tthis.updateDisplay();\r\n\t}\r\n\r\n\t// Updates the display\r\n\tthis.updateDisplay = function() {\r\n\t\tvar display = document.querySelector(\"#output\");\r\n\t\tdisplay.innerHTML = this.expressionStr;\r\n\t}\r\n\r\n\tthis.handleKeyPress = function(e) {\r\n\t\tswitch (e.code) {\r\n\t\t\tcase \"Numpad0\":\r\n\t\t\tcase \"Digit0\":\r\n\t\t\t\tif (e.shiftKey)\r\n\t\t\t\t\tthis.updateExpression(\")\");\r\n\t\t\t\telse\r\n\t\t\t\t\tthis.updateExpression(0);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Numpad1\":\r\n\t\t\tcase \"Digit1\":\r\n\t\t\t\tthis.updateExpression(1);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Numpad2\":\r\n\t\t\tcase \"Digit2\":\r\n\t\t\t\tthis.updateExpression(2);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Numpad3\":\r\n\t\t\tcase \"Digit3\":\r\n\t\t\t\tthis.updateExpression(3);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Numpad4\":\r\n\t\t\tcase \"Digit4\":\r\n\t\t\t\tthis.updateExpression(4);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Numpad5\":\r\n\t\t\tcase \"Digit5\":\r\n\t\t\t\tthis.updateExpression(5);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Numpad6\":\r\n\t\t\tcase \"Digit6\":\r\n\t\t\t\tthis.updateExpression(6);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Numpad7\":\r\n\t\t\tcase \"Digit7\":\r\n\t\t\t\tthis.updateExpression(7);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Numpad8\":\r\n\t\t\tcase \"Digit8\":\r\n\t\t\t\tthis.updateExpression(8);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Numpad9\":\r\n\t\t\tcase \"Digit9\":\r\n\t\t\t\tif (e.shiftKey)\r\n\t\t\t\t\tthis.updateExpression(\"(\");\r\n\t\t\t\telse\r\n\t\t\t\t\tthis.updateExpression(9);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Escape\":\r\n\t\t\t\tthis.updateExpression(\"AC\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Backspace\":\r\n\t\t\t\tthis.updateExpression(\"DEL\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Slash\":\r\n\t\t\tcase \"NumpadDivide\":\r\n\t\t\t\tthis.updateExpression(\"/\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Minus\":\r\n\t\t\tcase \"NumpadSubtract\":\r\n\t\t\t\tthis.updateExpression(\"-\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"NumpadAdd\":\r\n\t\t\t\tthis.updateExpression(\"+\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"NumpadMultiply\":\r\n\t\t\t\tthis.updateExpression(\"*\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"NumpadEnter\":\r\n\t\t\t\tthis.solve();\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Equal\":\r\n\t\t\t\tif (e.shiftKey)\r\n\t\t\t\t\tthis.updateExpression(\"+\");\r\n\t\t\t\telse\r\n\t\t\t\t\tthis.solve();\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"ArrowUp\":\r\n\t\t\tcase \"ArrowDown\":\r\n\t\t\t\tvar hist = this.history.getHistory();\r\n\r\n\t\t\t\tvar item = \"undefined\";\r\n\t\t\t\tif (e.code == \"ArrowUp\") {\r\n\t\t\t\t\titem = hist[(this.historyIndex + 1) % hist.length];\r\n\t\t\t\t\tif (item != null && item != \"undefined\")\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.historyIndex = (this.historyIndex + 1) % hist.length;\r\n\t\t\t\t\t\tthis.expressionStr = item;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// wrap the index\r\n\t\t\t\t\t\tthis.historyIndex = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\titem = hist[(this.historyIndex - 1) % hist.length];\r\n\t\t\t\t\tif (item != null && item != \"undefined\")\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.historyIndex = (this.historyIndex - 1) % hist.length;\r\n\t\t\t\t\t\tthis.expressionStr = item;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// wrap the index\r\n\t\t\t\t\t\tthis.historyIndex = hist.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.updateDisplay();\r\n\t\t\t\tbreak;\r\n\t\t}\t\r\n\t}\r\n}"]}